import{O as v,_ as q,r,a as E,D as F,o as A,b as D,c as i,d as u,e as g,f as e,F as b,i as N,u as c,l as C,t as l,h as R,j as T,H as j,x as z,y as U,z as W,I as O,E as P}from"./index.c7555ed6.js";import{u as $}from"./cart.299e1b0b.js";import{b as S}from"./cart.7af03791.js";function G(o){return v({url:"/api/order/settlement",method:"post",data:o})}function J(o){return v({url:"/api/pay/alipay/createOrder",method:"post",data:o})}function V(o){return v({url:"/api/pay/alipay/queryOrder",params:o})}function K(o){return v({url:"/api/pay/wxpay/createOrder",method:"post",data:o})}const m=o=>(U("data-v-94f7262a"),o=o(),W(),o),Q={class:"confirmOrder"},X=m(()=>e("div",{class:"bgColor"},[e("h1",{class:"main-shopcart"},"\u786E\u8BA4\u8BA2\u5355")],-1)),Y={class:"main"},Z={class:"info"},ee=m(()=>e("div",{class:"head"},"\u5546\u54C1\u4FE1\u606F",-1)),se={class:"courseInfo"},oe={class:"coursebg"},ae=["src"],te={class:"courseName"},re={class:"coursePrice"},ce={class:"nowprice"},le={class:"oldprice"},ne={class:"choose"},de={class:"pay"},ie={class:"choosebg"},ue=["onClick"],_e={class:"foot"},pe={class:"foot-item"},he={class:"unique"},ve={class:"dialogPrice"},me={class:"prices"},fe={class:"codeimg"},ye=["src"],ge=m(()=>e("div",{class:"alert"},"\u8BF7\u60A8\u53CA\u65F6\u4ED8\u6B3E\uFF0C\u5DF2\u4FBF\u8BA2\u5355\u5C3D\u5FEB\u5904\u7406\uFF01",-1)),be=m(()=>e("div",{class:"finish"},[e("div",{class:"error"},"\u652F\u4ED8\u9047\u5230\u95EE\u9898"),e("div",{class:"success"},"\u6211\u5DF2\u652F\u4ED8")],-1)),Ce={__name:"ConfirmOrder",setup(o){const _=r(!1);let n=$(),x=r([]),f=r(0),d=E({description:"\u6682\u65E0\u9009\u62E9\u652F\u4ED8\u65B9\u5F0F"}),k=r([]),y=r(""),p=r(""),h=r(""),I=F();A(()=>{G(n.orderList).then(s=>{x.value=s.data.courses,f.value=s.data.totalPrice,k.value=s.data.payModes})});const w=s=>{d.description=s.description,d.code=s.code,d.code=="alipayment"?J({courses:n.orderList,payModes:s.code}).then(a=>{y.value=a.data.payurl,p.value=a.data.orderNumber}):K({courses:n.orderList,payModes:s.code}).then(a=>{y.value=a.data.payurl,p.value=a.data.orderNumber})},M=()=>{V({orderNumber:p.value}).then(s=>{console.log(s),s.meta.code=="200"&&(clearInterval(h.value),O.success({message:"\u652F\u4ED8\u6210\u529F!"}),I.push({name:"Home"}),P().then(a=>{S(n.select,a.data.token)}))})},B=()=>{V({orderNumber:p.value}).then(s=>{console.log(s),s.meta.code=="200"&&(clearInterval(h.value),O.success({message:"\u652F\u4ED8\u6210\u529F!"}),I.push({name:"Home"}),P().then(a=>{S(n.select,a.data.token)}))})},H=()=>{d.code=="alipayment"?h.value=setInterval(M,2e3):h.value=setInterval(B,2e3),_.value=!0};return(s,a)=>{const L=D("el-dialog");return i(),u(b,null,[g(j),e("div",Q,[X,e("div",Y,[e("div",Z,[ee,(i(!0),u(b,null,N(c(x),t=>(i(),u("div",{class:"info-main",key:t.id},[e("div",se,[e("div",oe,[e("img",{src:t.courseCover,alt:""},null,8,ae)]),e("div",te,l(t.courseName),1),e("div",re,[e("span",ce,"\uFFE5"+l(t.discountPrice),1),e("span",le,"\uFFE5"+l(t.salePrice),1)])])]))),128)),e("div",ne,[e("h3",null,[C(" \u652F\u4ED8\u65B9\u5F0F "),e("span",de,l(c(d).description),1)]),e("div",ie,[(i(!0),u(b,null,N(c(k),t=>(i(),u("span",{key:t.code,onClick:xe=>w(t)},l(t.description),9,ue))),128))])]),e("ul",_e,[e("li",pe,[C(" \u5E94\u4ED8"),e("span",he,"\uFFE5"+l(c(f)),1)]),e("li",null,[e("button",{class:"btn",onClick:H},"\u786E\u8BA4\u8BA2\u5355")])])])]),g(L,{modelValue:c(_),"onUpdate:modelValue":a[0]||(a[0]=t=>T(_)?_.value=t:null),class:"pay-dialog",width:"500px"},{default:R(()=>[e("div",ve,[C(" \u652F\u4ED8\uFF1A"),e("span",me,l(c(f))+"\u5143",1)]),e("div",fe,[e("img",{src:c(y)},null,8,ye)]),ge,be]),_:1},8,["modelValue"])]),g(z)],64)}}};var Oe=q(Ce,[["__scopeId","data-v-94f7262a"]]);export{Oe as default};
